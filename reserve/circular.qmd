### Описательные статистики и тесты {#circular_tests}

Стандартная функция `summary()`, вычисляющая описательные статистики, работает и для дирекционных данных:

```{r}
summary(tiksi_wind$wind)
```

### Корреляция и регрессия {#circular_correlation}

Существуют методы расчета показателей связи между двумя переменными, по крайней мере одна из которых является циркулярной (или сферической, если положение задается двумя углами). Их можно поделить на три большие группы, в зависимости от того, какая из переменных отвечает за направление:

-   линейная---циркулярная;
-   циркулярная---циркулярная;
-   сферическая---сферическая;

Классический пример использования корреляций вида "линейная-циркулярная" в географии --- это, например, вычисление зависимости между густотой древостоя и экспозицией склона. Корреляции вида "сферическая --- сферическая" применяются, когда сравниваются два явления, заданные на градусной сетке (широты и долготы).

Поскольку направление является дирекционной переменной, стандартные методы вычисления корряляций к ним неприменимы. Существует ряд специальных метрик для этих целей. Одной из метрик вида "циркулярная--- циркулярная" является коэффициент Фишера (1983), который связывает две переменные $\Theta$ и $\Phi$ используя их выборки $\hat{\Theta} = \{\theta_1, \theta_2,...\theta_n\}$ и $\hat{\Phi} = \{\phi_1, \phi_2,...\phi_n\}$:

```{=tex}
\begin{equation}
\hat{\rho}_T = \frac{\sum_{i \leq j} \sin(\theta_i - \theta_j) \sin(\phi_i - \phi_j)}{\sqrt{\sum_{i \leq j} \sin^2(\theta_i - \theta_j) \sum_{i \leq j} \sin(\phi_i - \phi_j)}}.
\end{equation}
```
Эта метрика обладает следующими особенностями:

-   $-1 \leq \rho_T \leq 1$;
-   если $\Theta$ и $\Phi$ независимы, то $\rho_T = 0$;
-   $\rho_T = 1$ тогда и только тогда, когда $\Theta = \Phi + \xi \mod 2\pi$ для некого постоянного угла $\xi$;
-   $\rho_T = -1$ тогда и только тогда, когда $\Theta = -\Phi + \xi \mod 2\pi$ для некоторого постоянного угла $\xi$;
-   $\rho_T$ инвариантна относительно изменения нуля отсчета $\Theta$ and $\Phi$;
-   отражение $\Theta$ or $\Phi$ меняет знак $\rho_T$, но его абсолютная величина остается прежней;
-   если распределения $\Theta$ и $\Phi$ унимодальные и концентрированные вокруг какого-то значения, то $\rho_T(\Theta, \Phi)$ может быть аппроксимировано обычным коэффициентом корреляции Пирсона $\rho(\Theta, \Phi)$.

1.  Загрузите [файл](https://github.com/tsamsonov/r-geo-course/blob/master/data/gem_faults.xlsx) с фрагментом базы данных [**GEM Global Active Faults**](https://github.com/GEMScienceTools/gem-global-active-faults) по линеаментам сейсмически активных разломов:

    ```{r, echo = FALSE}
    knitr::include_graphics('images/gem_faults.png')
    ```

    Данный файл содержит информацию по разломам Байкальской рифтовой зоны (каталог `EMME`) и Большого Кавказского хребта (каталог `GEM_NE_Asia`). При его построении исходные линии были разбиты на отрезки одинаковой длины и азимут каждого отрезка вычислен в поле `dir`. Преобразуйте эти данные к типу `circular`, вычислите описательные статистики направлений разломов для двух участков, а также постройте для них розы-диаграммы с выделенным модальным направлением и функцией плотности распределения направлений. Выведите в подзаголовок графика название участка.

    > **Совет:** чтобы не вызывать последовательность функций построения розы-диаграммы для каждого графика, соберите их в одну функцию, которая принимает в качестве пераметров вектор типа `circular`, заголовок графика и подзаголовок графика.

2.  Используя [таблицу](https://github.com/tsamsonov/r-geo-course/blob/master/data/tverobl_streets.xlsx), подготовленную на основе данных [**OpenStreetMap**](https://www.openstreetmap.org/#map=3/69.62/-74.90), проведите аналогичный анализ направлений (поле `dir`) для улиц четырех городов Тверской области (*Бежецк, Бологое, Кашин, Торжок*).

    > **Внимание:** В этой таблице, в отличие от предыдущей, направление рассчитано в диапазоне от 0 до 360 градусов. Чтобы корректно оценить распределение направлений, необходимо перед вычислением круговых статистик вычесть 180 из углов, больших 180 градусов.
